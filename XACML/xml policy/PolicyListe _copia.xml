<?xml version="1.0" encoding="UTF-8"?>
<Policy xmlns="urn:oasis:names:tc:xacml:1.0:policy" xmlns:xsi="http://www.w3.org/2001/XMLSchema-instance" PolicyId="PolicyListe" RuleCombiningAlgId="urn:oasis:names:tc:xacml:1.0:rule-combining-algorithm:permit-overrides">
  <Description>
    Disciplina l'accesso alle liste.
  </Description>

  <Target>
    <Subjects>
     <AnySubject/>
    </Subjects>

    <Resources>
     <Resource>
      <ResourceMatch MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
        <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Lista</AttributeValue>
        <ResourceAttributeDesignator DataType="http://www.w3.org/2001/XMLSchema#string" AttributeId="urn:progetto:names:resource-type"/>
      </ResourceMatch>
     </Resource>
    </Resources>

    <Actions>
      <AnyAction/>
    </Actions>
  </Target>

  <Rule RuleId="EliminaLista" Effect="Permit">
    <Target>
      <Subjects>
       <AnySubject/>
      </Subjects>

      <Resources>
        <AnyResource/>
      </Resources>

      <Actions>
        <Action>
          <ActionMatch MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Elimina</AttributeValue>
            <ActionAttributeDesignator DataType="http://www.w3.org/2001/XMLSchema#string" AttributeId="urn:progetto:names:action-type"/>
          </ActionMatch>
        </Action>
      </Actions>
    </Target>
  </Rule>

  <Rule RuleId="ModificaLista" Effect="Permit">
    <Target>
      <Subjects>
       <AnySubject/>
      </Subjects>

      <Resources>
        <AnyResource/>
      </Resources>

      <Actions>
        <Action>
          <ActionMatch MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Modifica</AttributeValue>
            <ActionAttributeDesignator DataType="http://www.w3.org/2001/XMLSchema#string" AttributeId="urn:progetto:names:action-type"/>
          </ActionMatch>
        </Action>
      </Actions>
    </Target>
  </Rule>

  <Rule RuleId="VisualizzaLista" Effect="Permit">
    <Target>
      <Subjects>
       <AnySubject/>
      </Subjects>

      <Resources>
        <AnyResource/>
      </Resources>

      <Actions>
        <Action>
          <ActionMatch MatchId="urn:oasis:names:tc:xacml:1.0:function:string-equal">
            <AttributeValue DataType="http://www.w3.org/2001/XMLSchema#string">Visualizza</AttributeValue>
            <ActionAttributeDesignator DataType="http://www.w3.org/2001/XMLSchema#string" AttributeId="urn:progetto:names:action-type"/>
          </ActionMatch>
        </Action>
      </Actions>
    </Target>
  </Rule>

  <Rule RuleId="NessunaRegolaApplicabileListe" Effect="Deny"/>
</Policy>
